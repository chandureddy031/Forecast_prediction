<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ML Pipeline Dashboard</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); min-height:100vh; padding:20px; color:#333; }
    .container { max-width:1200px; margin:0 auto; }
    .header { text-align:center; color:white; margin-bottom:40px; }
    .header h1 { font-size:3em; margin-bottom:10px; }
    .header p { font-size:1.2em; opacity:0.9; }
    .card { background:white; border-radius:15px; padding:30px; margin-bottom:20px; box-shadow:0 10px 30px rgba(0,0,0,0.2); }
    .card h2 { color:#667eea; margin-bottom:20px; font-size:1.8em; }
    .metrics-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px; margin-top:20px; }
    .metric-box { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:20px; border-radius:10px; text-align:center; }
    .metric-box h3 { font-size:0.9em; opacity:0.9; margin-bottom:10px; }
    .metric-box .value { font-size:2em; font-weight:bold; }
    .prediction-form { margin-top:20px; }
    .form-group { margin-bottom:20px; }
    .form-group label { display:block; margin-bottom:8px; color:#333; font-weight:600; }
    .info-text { font-size:0.9em; color:#666; margin-bottom:10px; background:#f0f0f0; padding:10px; border-radius:5px; }
    .info-text code { background:#e0e0e0; padding:2px 6px; border-radius:3px; font-family:monospace; }
    .form-group textarea, .form-group select { width:100%; padding:12px; border:2px solid #e0e0e0; border-radius:8px; font-size:14px; }
    .form-group textarea { font-family:monospace; resize:vertical; }
    .btn { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; padding:12px 30px; border:none; border-radius:8px; font-size:1.1em; cursor:pointer; transition:transform 0.2s; margin-right:10px; margin-bottom:10px; }
    .btn:hover { transform:translateY(-2px); }
    .btn.secondary { background:#6c757d; }
    .result { margin-top:20px; padding:15px; background:#f0f0f0; border-radius:8px; display:none; overflow-x:auto; }
    .result.success { background:#d4edda; border:1px solid #c3e6cb; }
    .result.error { background:#f8d7da; border:1px solid #f5c6cb; }
    .status { display:inline-block; padding:5px 15px; border-radius:20px; font-size:0.9em; font-weight:600; }
    .status.healthy { background:#d4edda; color:#155724; }
    .loading { display:none; text-align:center; padding:20px; }
    .spinner { border:4px solid #f3f3f3; border-top:4px solid #667eea; border-radius:50%; width:40px; height:40px; animation:spin 1s linear infinite; margin:0 auto; }
    @keyframes spin { 0%{transform:rotate(0deg);}100%{transform:rotate(360deg);} }
    .example-section { margin-top:15px; padding:10px; background:#e8f4f8; border-radius:5px; border-left:4px solid #667eea; }
    .example-section h4 { color:#667eea; margin-bottom:8px; }
    .prediction-table { width:100%; border-collapse:collapse; margin-top:15px; background:white; border-radius:8px; overflow:hidden; }
    .prediction-table th, .prediction-table td { padding:12px; text-align:left; border-bottom:1px solid #e0e0e0; }
    .prediction-table th { background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; font-weight:600; }
    .prediction-table tr:hover { background:#f5f5f5; }
    .prediction-highlight { background:#fff3cd; padding:15px; border-radius:8px; margin-top:15px; border-left:4px solid #ffc107; }
    .example-selector { display:flex; align-items:center; gap:10px; margin-bottom:15px; }
    .example-selector label { margin:0; min-width:150px; }
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üöÄ ML Pipeline Dashboard</h1>
        <p>LSTM Time Series Prediction System</p>
    </div>

    <div class="card">
        <h2>üìä Model Performance Metrics</h2>
        <div class="metrics-grid" id="metricsGrid">
            <div class="loading"><div class="spinner"></div><p>Loading metrics...</p></div>
        </div>
    </div>

    <div class="card">
        <h2>üîÆ Make Predictions</h2>
        <div class="prediction-form">
            <div class="form-group">
                <div class="example-selector">
                    <label for="exampleSelect">üìã Choose Example Data:</label>
                    <select id="exampleSelect" onchange="loadSelectedExample()">
                        <option value="">-- Select an example --</option>
                        <option value="1">Example 1: Random Trend (Upward)</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="sequenceInput">Enter Data (CSV format - 60 rows √ó 10 columns):</label>
                <div class="info-text">
                    üìù <strong>How to use:</strong><br>
                    ‚Ä¢ Select an example OR paste your data<br>
                    ‚Ä¢ Format: value,feature1,feature2,lag1,lag7,lag30,rolling_mean7,rolling_std7,rolling_mean30,rolling_std30
                </div>
                <textarea id="sequenceInput" rows="10"></textarea>
            </div>
            <button class="btn" onclick="makePrediction()">üîÆ Predict</button>
            <button class="btn secondary" onclick="clearInput()">üóëÔ∏è Clear</button>

            <div class="example-section">
                <h4>üí° What the Model Predicts:</h4>
                <p style="font-size:0.9em; color:#555;">
                    Based on the last 60 days of data, predicts values for <strong>Day 61 (Tomorrow)</strong>.
                </p>
            </div>

            <div class="loading" id="predictionLoading"><div class="spinner"></div><p>Processing...</p></div>
            <div class="result" id="predictionResult"></div>
        </div>
    </div>

    <div class="card">
        <h2>üíö System Health</h2>
        <div id="healthStatus"><span class="status healthy">System Healthy</span></div>
    </div>
</div>

<script>
// Feature names
const FEATURE_NAMES = ['Main Value','Feature 1','Feature 2','Value (1 day ago)','Value (7 days ago)','Value (30 days ago)','Rolling Mean (7 days)','Rolling Std Dev (7 days)','Rolling Mean (30 days)','Rolling Std Dev (30 days)'];

// Sample data for input (60 rows √ó 10 columns)
const defaultData = Array.from({length:60}, (_,i)=>{
    const base = 0.5 + i*0.01;
    return Array.from({length:10}, ()=> (base + (Math.random()*0.1-0.05)).toFixed(4));
}).map(row=>row.join(',')).join('\n');

document.getElementById('sequenceInput').value = defaultData;

// Load example (same as default for simplicity)
function loadSelectedExample() {
    const val = document.getElementById('exampleSelect').value;
    if(val==='1') document.getElementById('sequenceInput').value = defaultData;
}

// Parse CSV
function parseCSVInput(csvText){
    const lines=csvText.trim().split('\n').filter(l=>l.trim()!=='');
    const data=[];
    for(const line of lines){
        const values=line.split(',').map(v=>parseFloat(v.trim()));
        if(values.some(isNaN)) throw new Error(`Invalid data in line: ${line}`);
        data.push(values);
    }
    return data;
}

function clearInput(){ document.getElementById('sequenceInput').value=''; document.getElementById('exampleSelect').value=''; document.getElementById('predictionResult').style.display='none'; }

async function makePrediction(){
    const resultDiv=document.getElementById('predictionResult');
    const loadingDiv=document.getElementById('predictionLoading');
    loadingDiv.style.display='block'; resultDiv.style.display='none'; resultDiv.innerHTML='';

    try{
        const csvText=document.getElementById('sequenceInput').value.trim();
        if(!csvText) throw new Error('No data provided.');
        const data=parseCSVInput(csvText);
        if(data.length!==60) throw new Error('Data must have 60 rows.');
        if(!data.every(row=>row.length===10)) throw new Error('Each row must have 10 columns.');

        // Simulate backend prediction
        const prediction = data[59].map(v=>parseFloat(v)+0.05); // simple next-step mock
        let html='<h4>Predicted Values for Day 61:</h4>';
        html+='<table class="prediction-table"><thead><tr><th>Feature</th><th>Predicted Value</th></tr></thead><tbody>';
        prediction.forEach((v,i)=>{ html+=`<tr><td>${FEATURE_NAMES[i]}</td><td>${v.toFixed(4)}</td></tr>`; });
        html+='</tbody></table>';
        resultDiv.innerHTML=html; resultDiv.className='result success'; resultDiv.style.display='block';
    } catch(err){
        resultDiv.innerHTML=`<strong>Error:</strong> ${err.message}`;
        resultDiv.className='result error'; resultDiv.style.display='block';
    } finally{ loadingDiv.style.display='none'; }
}

// Dummy metrics & health functions
window.onload=function(){
    const metricsGrid=document.getElementById('metricsGrid');
    const dummyMetrics={rmse:0.1234,mae:0.2345,mape:1.2345};
    metricsGrid.innerHTML='';
    for(const [k,v] of Object.entries(dummyMetrics)){
        const box=document.createElement('div'); box.className='metric-box'; box.innerHTML=`<h3>${k.toUpperCase()}</h3><div class="value">${v.toFixed(4)}</div>`;
        metricsGrid.appendChild(box);
    }
};
</script>
</body>
</html>
